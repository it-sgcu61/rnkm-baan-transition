<html>

<head>
    <script src="src/js/jquery-3.3.1.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-rc.2/css/materialize.min.css">
</head>

<body>
        <label>TEL</label> <input class="tel">
        <label>ID</label> <input class="idcard">
        <button id="submit">Login</button>
    <script>
        $(document).ready(function(){
            var proxy = 'https://cryptic-headland-94862.herokuapp.com/'; // credit to pooomrokc LUL
            var token = document.cookie;
            $('#submit').on('click', {}, () => {
                var username = $('.tel').val(); 
                var password = $('.idcard').val();
                console.log(username, password);
                $.ajax({
                    url: proxy+'https://us-central1-rnkm2018-house-ad25ge.cloudfunctions.net/login',
                    contentType: 'application/x-www-form-urlencoded',
                    data: {'username': username, 'password': password},
                    method: 'POST',
                    success: function (res){
                        // console.log(res.cookie);
                        if (res.success === true){
                            document.cookie = `token=${res.token}; path=/; expires=${res.expire}`
                            document.cookie = `username=${username}; path=/; expires=${res.expire}`
                            // alert(res.message);
                            window.location.href = 'index.html';
                        }
                        else {
                            alert('wrong id/tel');
                        }
                    }
                });

            });
            if (token !== ''){
                // validate
            }
            else {
            }
        });
    
    </script>
</body>

</html>